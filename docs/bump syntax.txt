Sleepy Shows — Bump Script Syntax

Overview
- Bump scripts are plain text files (often .txt) loaded from your bump scripts folder.
- A file may contain one or more bumps, each starting with a <bump ...> header.
- Inside a bump, you author cards (text/images) and pauses.

Global Timing Rules
- Bumps longer than 35 seconds are skipped (will not play).
- If a bump is between 29 and 35 seconds, only auto-timed cards are proportionally reduced so the total bump duration becomes exactly 29 seconds.
  - Outro timing is never changed.
  - Cards with explicit <card ...> durations are never changed.

Top-Level Tags

<bump ...>
- Starts a new bump.
- Optional attribute:
  - music=any
    - Picks any eligible bump music track.
  - music=SomeFile.mp3
    - Requires that exact filename to be used (must exist in the bump music folder).

<card ...>
- Starts a new card.
- The card content is all text until the next tag (<card>, <pause>, <outro>, or next <bump ...>).

Card Duration Overrides
By default, card duration is computed from the text length (readability timing model).
You can override duration using milliseconds or seconds:

- <card>          -> use standard computed time
- <card 500ms>    -> absolute 500ms (then clamped to app min/max)
- <card 5s>       -> absolute 5 seconds (same behavior as ms)
- <card +500ms>   -> standard + 500ms
- <card -500ms>   -> standard - 500ms
- <card +2s>      -> standard + 2 seconds
- <card -1.5s>    -> standard - 1.5 seconds

Note: Card durations are clamped to the app’s configured min/max card duration.

<pause ...>
- Inserts a timed pause with no text/image.
- Supported:
  - <pause>         -> default (currently 1200ms)
  - <pause=1200>    -> 1200ms
  - <pause=1200ms>  -> 1200ms

<outro ...>
- Adds a short closing card at the end of the bump.
- Supported:
  - <outro>                     -> default outro text
  - <outro="[sleepy shows]">     -> custom outro text
  - <outro="[sleepy shows]" audio>
    - Plays a random outro sound at the same time as the outro text.
    - The outro sound may be cut off.
    - The outro duration is never extended.

Whitespace Tags (inline)
These are expanded into real whitespace in card text:
- <\s> -> a space character
- <\t> -> a tab character
- <\n> -> a newline character

Example:
<card>
A<\s>B<\t>C<\n>D

Image Tags
Images are referenced by filename only and resolved from the configured Bump Images Folder.

<img filename>
- Renders an image using the default fit/stretch rules.

<img filename lines>
- Renders a block image and reserves vertical space for the text lines above/below the <img ...> tag.
- The image scales down (maintaining aspect ratio) so the text can still fit on the card.

Example:
<card>
Hello this is line 1.
<img dress.png lines>
This is line 2.
And this is line 3.

<img filename char>
- Renders an inline image (similar to an emoji) with the same height as the surrounding text.
- Use this for tiny icons next to text.

<img filename 20%>
- Scales the image down until either width or height reaches 20% of the viewport (whichever hits first), then centers it.

Notes
- Currently only one <img ...> tag per card is supported.
- If an image cannot be loaded, the card falls back to showing the surrounding text.

Sound Tags
Sound effects are referenced by filename only and resolved from the configured Bump Audio FX Folder.

<sound filename ...>
Plays a sound effect during a card. The sound does NOT control card/bump duration.

Mix mode (how it interacts with bump music):
- <sound ding.wav add ...>
  - Plays over the bump music without stopping it.
- <sound ding.wav interrupt ...>
  - Mutes the bump music while the sound plays, then restores it.
- <sound ding.wav cut ...>
  - Permanently mutes the bump music for the remainder of the bump.

Note:
- <outro ... audio> behaves like a permanent cut and also blocks other bump FX while it plays.

Playback length (choose one):
- <sound ding.wav duration>
  - Plays for the file’s full duration, but will be cut off when the bump ends.
- <sound ding.wav card>
  - Plays for the duration of its containing <card>.
- <sound ding.wav 500ms>
  - Plays for a fixed time in milliseconds.
- <sound ding.wav 5s>
  - Plays for a fixed time in seconds.

Examples:
<card>
Text on screen.
<sound click.wav add card>

<card>
<sound whoosh.wav interrupt 750ms>

Settings
- Bump Images Folder: defaults to TV Vibe/images when auto-detected on the external drive.
- Bump Audio FX Folder: defaults to TV Vibe/audio when auto-detected on the external drive.

Music Selection Notes
- Bump music uses a FIFO queue to avoid repeats in close proximity.
- Short bumps (15 seconds or under) prefer to use short music tracks (15s or under) when possible.
